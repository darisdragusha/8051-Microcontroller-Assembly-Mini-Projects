; DATA RECEPTION THROUGH RX AT BR = 9600BPS, DATA TRANSMISSION THROUGH P1.0 AT A BR ~ 9600 BPS
;
	ORG	0000H
	LJMP	INIT

INIT:
	MOV	SCON, #50H
	MOV	TMOD, #20H
	MOV	TH1, #252	; -3 FOR 9600BPS
	SETB	TR1

MAIN:
	ACALL	RECEIVE
	ACALL	TRANSMIT
	SJMP	MAIN

RECEIVE:
	JNB	RI, $
	CLR	RI
	MOV	A, SBUF
	RET

TRANSMIT:
	CLR	C
	MOV	R0, #8
ALL_BITS:
	RLC	A
	MOV	P1.0, C
	ACALL	DELAY_1250US	; AT A DELAY OF 1250US THE BR ~ 9600BPS
	DJNZ	R0, ALL_BITS
	RET

DELAY_1250US:
	MOV	R7, #100
DELAY_LOOP:
	MOV	R6, #4
	DJNZ	R6, $
	DJNZ	R7, DELAY_LOOP
	MOV	R7, #73
	DJNZ	R7, $
	RET

	END
