; MATRIX BCD KEYPAD, READ THE KEY AND SHOW IT IN A HEX 7-SEGMENT

	ORG	0000H
	LJMP	MAIN

MAIN:
	ACALL	GET_KEY
	MOV	A, B
	ACALL	DISPLAY_HEX
	SJMP	MAIN

GET_KEY:
ROW1:
	CLR	P1.0
	JB	P1.4, CHECK_2
	MOV	B, #1
	INC	A
CHECK_2:
	JB	P1.5, CHECK_3
	MOV	B, #2
	INC	A
CHECK_3:
	JB	P1.6, CHECK_4
	MOV	B, #3
	INC	A
CHECK_4:
ROW_2:
	SETB	P1.0
	CLR	P1.1
	JB	P1.4, CHECK_5
	MOV	B, #4
	INC	A
CHECK_5:
	JB	P1.5, CHECK_6
	MOV	B, #5
	INC	A
CHECK_6:
	JB	P1.6, CHECK_7
	MOV	B, #6
	INC	A
CHECK_7:
ROW_3:
	JB	P1.4, CHECK_8
	MOV	B, #7
	INC	A
CHECK_8:
	JB	P1.5, CHECK_9
	MOV	B, #8
	INC	A
CHECK_9:
	JB	P1.6, CHECK_0
	MOV	B, #9
	INC	A
CHECK_0:
ROW4:
	JB	P2.5, MUL_OR_ZERO
	MOV	B, #0
	INC	A
MUL_OR_ZERO:
	CJNE	A, #1, ZERO_MUL
	RET
ZERO_MUL:
	JZ	ZERO
	MOV	B, #10
	RET
ZERO:
	MOV	B, #0FFH
	RET

DISPLAY_HEX:
	MOV	P3, A
    RET

    END


